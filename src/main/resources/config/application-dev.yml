# ===================================================================
# Spring Boot configuration for the "dev" profile.
# 切换为 H2 内存数据库，无需额外配置，直接启动
# ===================================================================

logging:
  level:
    ROOT: DEBUG
    tech.jhipster: DEBUG
    org.hibernate.SQL: DEBUG
    com.mycompany.myapp: DEBUG

spring:
  devtools:
    restart:
      enabled: true
      additional-exclude: static/**
    livereload:
      enabled: false # 用 Webpack + BrowserSync 实现热重载
  jackson:
    serialization:
      indent-output: true
  # 核心：H2 内存数据库配置（无需额外安装，嵌入式启动）
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: jdbc:h2:mem:jhipster-react-postgres-app;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    username: sa # H2 默认用户名，无需修改
    password: '' # H2 默认无密码，留空即可
    driverClassName: org.h2.Driver # 明确指定 H2 驱动，避免连接池报错
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect # H2 专用方言
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        jdbc:
          lob:
            non_contextual_creation: true
        format_sql: true
        hbm2ddl:
          auto: update
        show_sql: true
  # 启用 H2 控制台（可选，访问 http://localhost:8088/h2-console 查看数据库）
  h2:
    console:
      enabled: true
      path: /h2-console
      settings:
        web-allow-others: false
  liquibase:
    contexts: dev, faker # 自动初始化默认用户（admin/admin）和测试数据
  mail:
    host: localhost
    port: 25
    username:
    password:
  messages:
    cache-duration: PT1S
  thymeleaf:
    cache: false

server:
  port: 8088

# ===================================================================
# JHipster 专用配置（保持不变，确保认证、CORS 正常）
# ===================================================================
jhipster:
  cache:
    caffeine:
      time-to-live-seconds: 3600
      max-entries: 100
  cors:
    allowed-origins: 'http://localhost:8100,https://localhost:8100,http://localhost:9000,https://localhost:9000,http://localhost:9060,https://localhost:9060'
    allowed-origin-patterns: 'https://*.githubpreview.dev'
    allowed-methods: '*'
    allowed-headers: '*'
    exposed-headers: 'Authorization,Link,X-Total-Count,X-${jhipster.clientApp.name}-alert,X-${jhipster.clientApp.name}-error,X-${jhipster.clientApp.name}-params'
    allow-credentials: true
    max-age: 1800
  security:
    authentication:
      jwt:
        base64-secret: MDczNWFjN2ViMGQ3NThmMjQxOTJhZjJkYzk5NmNiMzQwYTBlNDNhODRmYTczNWVlZjcxZTY1Y2IxNzQxMTJjNTY2MTg0ZGE2NmI1MjczMDdiMDVjZjU4ODg0YmMzNDJiZjcwMzRkMmU4ZjZkMDE0Y2Y3YzU1YTU1NjI4ZjdmYjI=
        token-validity-in-seconds: 86400
        token-validity-in-seconds-for-remember-me: 2592000
  mail:
    base-url: http://127.0.0.1:8080
  logging:
    use-json-format: false
    logstash:
      enabled: false
      host: localhost
      port: 5000
      queue-size: 512
